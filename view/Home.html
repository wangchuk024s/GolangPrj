<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Tangerine">
    <title>Home</title>
    <style>
        
body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #fff;

    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  
  .nav{
    margin-bottom: 10rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #ddd6d5;
    
    position: fixed;
    width: 73%;
    margin-left: 2rem;
    
    height: 50px;
    
}
.logo{
    font-size: 3rem;
    font-family: 'Tangerine', serif;
    color: #000000;
    text-shadow: 4px 4px 4px #aaa;
}
/* home,about us, categories and services */
.top{
    display: flex;
    justify-content: end;
    /* justify-content: space-between; */
    align-items: right;
    flex: 1;
    font-size: 20px;
    
}
a{
    margin: 1rem;
    text-decoration: none;
    color:#473434;
    font-size: 16px;
} 

a:hover{
    background-color: #4e54c8;
}
/* efvtawebfjearferagfeargergergesarg */

  .maincontainer h1{
    color:#fff;
    text-align: center;
  }
  form label {
    display: block;
    margin-bottom: 20px;
    margin-left: 10px;
    color: #fff;
  }
  
  form input[type="text"] {
    width: 90%;
    padding: 10px;
    margin:auto;
    border-radius: 20px;
    border:2px solid #8f94fb;
    box-shadow: 0px 0px 11px 4px rgba(0, 0, 0, 0.25);
  }
  
  form button {
    background-color: #fff;
    color: #8f94fb;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 10px;
    font-size: 25px;
    margin-top: 20px;
  }
  form button:hover{
    border:2px solid #8f94fb;
  }
  
  #short-url-container {
    margin-top: 20px;
  }
  #short-url-container p{
    text-align: center;
    color: #fff;
  }
  
  #short-url {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  #short-url a {
    word-wrap: break-word;
    margin-right: 10px;
    color: #fff;
  }

  .maincontainer
  {
    width:80%;
    height: auto;
    min-height:350px;
    padding:40px;
    border-radius: 30px;
    box-shadow: 0px 0px 11px 4px rgba(0, 0, 0, 0.25);
    background: #4e54c8;
    background: -webkit-linear-gradient(to right, #8f94fb, #4e54c8);  
    background: linear-gradient(to right, #8f94fb, #4e54c8);
    margin: auto;
  }

  #copy-btn{
    background-color: #fff;
    color: #8f94fb;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 10px;
    font-size: 25px;
    margin-top: 20px;
  }
  .credit a {
    text-decoration: none;
    color: #000;
    font-weight: 800;
}

.credit {
    text-align: center;
    margin-top: 10px;
    font-family: Verdana,Geneva,Tahoma,sans-serif;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 7rem;
  }
  
  th {
    background-color: black;
    color: white;
    padding: 10px;
  }
  
  th,
  td {
    border: 1px solid #ccc;
    padding: 10px;
  }
  
  tbody tr:nth-child(even) {
    background-color: #f2f2f2;
  }

  
/*........................ Footer starting */
.footer{
    margin-top: 10rem;
    height: 60px;
    background-color: #DDD6D5;
    display: flex;
    align-items: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.footer h3{

    font-size: 12px;
    font-weight: 100;
    font-family: sans-serif;
}

    </style>
    <style>
        /* CSS styles for the page */
        
    
        .container {
            
          max-width: 500px;
          margin: 0 auto;
          padding: 20px;
        }
    
        h1 {
          text-align: center;
        }
    
        label {
          display: block;
          margin-top: 10px;
        }
    
        input[type="text"], textarea {
          width: 100%;
          padding: 8px;
          font-size: 16px;
          margin-top: 5px;
        }
    
        button {
          padding: 10px 20px;
          font-size: 16px;
          background-color: #4CAF50;
          color: white;
          border: none;
          cursor: pointer;
        }
      </style>
</head>

<body>

    

    
  

    <div class="maincontainer">
        <!-- beginning of navigation bar -->
    <div class="nav" style="margin-right: 0;">
        <div class="logo" >
            <p>LINKA</p>
        </div>

        <div class="top">
            <a href="Home.html">Home</a>

            <a href="linklist.html">Saved</a>

            <a href="profile.html">Profile</a>

            <a href="Login.html">LogOut</a>

        </div>

        
    </div> 
     <!-- end of navigation bar -->
        <h1 style="margin-top: 10rem;">URL Shortener</h1>
        <form>
          <label for="long-url">Enter or Paste Your long URL:</label>
          <input type="text" id="long-url" name="long-url">
          <button type="button" id="shorten-btn">Shorten</button>
        </form>
        <div id="short-url-container" style="display:none">
          <p>Here's your shortened URL:</p>
          <div id="short-url">
            <a href="" target="_blank"></a>
            <button type="button" id="copy-btn">Copy</button>
          </div>
        </div>
        <table >
            <thead>
              <tr>
                <th>ID</th>
                <th>Long URL</th>
                <th>Short URL</th>
                <th>Remove</th>
              </tr>
            </thead>
            <tbody id="url-table-body">
              <!-- Table rows will be dynamically added here -->
            </tbody>
        </table>

        <h1 style="margin-top: 10rem;">Save URL</h1>
        <form id="urlForm">
          <label for="id">ID:</label>
          <input type="text" id="id" placeholder="Enter the ID">
    
          <label for="name">Title:</label>
          <input type="text" id="name" placeholder="Enter the name">
    
          <label for="shortUrl">Short URL:</label>
          <input type="text" id="shortUrl" placeholder="Enter the short URL">
    
          <label for="details">Details:</label>
          <textarea id="details" placeholder="Enter the details"></textarea>
    
          <button type="submit">Submit</button>
        </form>

        <!-- beginning of footer -->
        
<div class="footer">

    <h3>@ Something Something Copyright Stuff</h3>

</div>

<!-- ending of footer -->
        
        <script>
            const shortenUrl = async () => {
    const longUrl = document.getElementById('long-url').value;
    const response = await fetch(`https://api.shrtco.de/v2/shorten?url=${longUrl}`);
    const data = await response.json();
    const shortUrl = data.result.full_short_link;
  
    const id = generateId(); // Generate a unique ID
  
    const shortUrlContainer = document.getElementById('short-url-container');
    const shortUrlLink = document.getElementById('short-url').querySelector('a');
    shortUrlLink.href = shortUrl;
    shortUrlLink.textContent = shortUrl;
    shortUrlContainer.style.display = 'block';
  
    const copyBtn = document.getElementById('copy-btn');
    copyBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(shortUrl).then(() => {
        alert('Copied to clipboard!');
      });
    });
  
    saveUrlMapping(id, longUrl, shortUrl); // Save the URL mapping with the generated ID
  };
  
  const shortenBtn = document.getElementById('shorten-btn');
  shortenBtn.addEventListener('click', shortenUrl);
  
  function generateId() {
    // Generate a random ID using timestamp and a random number
    const timestamp = Date.now().toString(36);
    const randomNumber = Math.random().toString(36).substr(2, 5);
    return timestamp + randomNumber;
  }
  
  function saveUrlMapping(id, longUrl, shortUrl) {
    // Create a new table row
    const tableBody = document.getElementById('url-table-body');
    const newRow = document.createElement('tr');
  
    // Create table cells for ID, Long URL, and Short URL
    const idCell = document.createElement('td');
    idCell.textContent = id;
  
    const longUrlCell = document.createElement('td');
    longUrlCell.textContent = longUrl;
  
    const shortUrlCell = document.createElement('td');
    const shortUrlLink = document.createElement('a');
    shortUrlLink.href = shortUrl;
    shortUrlLink.target = '_blank';
    shortUrlLink.textContent = shortUrl;
    shortUrlCell.appendChild(shortUrlLink);
  
    const deleteCell = document.createElement('td');
    const deleteButton = document.createElement('button');
    deleteButton.textContent = 'Delete';
    deleteButton.addEventListener('click', () => {
      deleteRow(newRow); // Call the deleteRow function passing the row element
    });
    deleteCell.appendChild(deleteButton);
  
    // Append cells to the new row
    newRow.appendChild(idCell);
    newRow.appendChild(longUrlCell);
    newRow.appendChild(shortUrlCell);
    newRow.appendChild(deleteCell);
  
    // Append the new row to the table body
    tableBody.appendChild(newRow);
  
    console.log(`URL mapping saved:\nID: ${id}\nLong URL: ${longUrl}\nShort URL: ${shortUrl}`);
  }
  
  function deleteRow(row) {
    // Remove the row from the table
    const tableBody = document.getElementById('url-table-body');
    tableBody.removeChild(row);
  }

  const urlForm = document.getElementById("urlForm");

    urlForm.addEventListener("submit", (event) => {
      event.preventDefault();

      const id = document.getElementById("id").value;
      const name = document.getElementById("name").value;
      const shortUrl = document.getElementById("shortUrl").value;
      const details = document.getElementById("details").value;

      // Create an object with form data
      const formData = {
        id,
        name,
        shortUrl,
        details,
      };

      // Make a POST request to the server with form data
      fetch("/add-url", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(formData),
      })
      .then((response) => response.json())
      .then((data) => {
        // Handle the response from the server
        console.log(data);
        // Reset the form after successful submission
        urlForm.reset();
      })
      .catch((error) => {
        console.error("Error:", error);
      });
    });
  
        </script>
    
</body>

</html>